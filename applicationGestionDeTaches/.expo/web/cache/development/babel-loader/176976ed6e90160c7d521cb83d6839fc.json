{"ast":null,"code":"import _extends from '@babel/runtime/helpers/extends';\nimport * as primitives from '@react-pdf/primitives';\nexport * from '@react-pdf/primitives';\nimport queue from 'queue';\nimport React, { useRef, useState, useEffect } from 'react';\nimport _asyncToGenerator from '@babel/runtime/helpers/asyncToGenerator';\nimport _regeneratorRuntime from '@babel/runtime/regenerator';\nimport FontStore from '@react-pdf/font';\nimport renderPDF from '@react-pdf/render';\nimport PDFDocument from '@react-pdf/pdfkit';\nimport layoutDocument from '@react-pdf/layout';\nimport _objectWithoutPropertiesLoose from '@babel/runtime/helpers/objectWithoutPropertiesLoose';\nimport ReactFiberReconciler from 'react-reconciler';\nimport { unstable_scheduleCallback, unstable_cancelCallback } from 'scheduler';\n\nvar propsEqual = function propsEqual(a, b) {\n  var oldPropsKeys = Object.keys(a);\n  var newPropsKeys = Object.keys(b);\n  if (oldPropsKeys.length !== newPropsKeys.length) {\n    return false;\n  }\n  for (var i = 0; i < oldPropsKeys.length; i += 1) {\n    var propName = oldPropsKeys[i];\n    if (propName === 'render' && !a[propName] !== !b[propName]) {\n      return false;\n    }\n    if (propName !== 'children' && a[propName] !== b[propName]) {\n      if (typeof a[propName] === 'object' && typeof b[propName] === 'object' && propsEqual(a[propName], b[propName])) {\n        continue;\n      }\n      return false;\n    }\n    if (propName === 'children' && (typeof a[propName] === 'string' || typeof b[propName] === 'string')) {\n      return a[propName] === b[propName];\n    }\n  }\n  return true;\n};\nvar _excluded$1 = [\"style\", \"children\"],\n  _excluded2 = [\"style\"];\nvar emptyObject = {};\nvar appendChild = function appendChild(parentInstance, child) {\n  var isParentText = parentInstance.type === 'TEXT';\n  var isChildTextInstance = child.type === 'TEXT_INSTANCE';\n  var isOrphanTextInstance = isChildTextInstance && !isParentText;\n\n  if (isOrphanTextInstance) {\n    console.warn(\"Invalid '\" + child.value + \"' string child outside <Text> component\");\n    return;\n  }\n  parentInstance.children.push(child);\n};\nvar createRenderer = function createRenderer(_ref) {\n  var _ref$onChange = _ref.onChange,\n    onChange = _ref$onChange === void 0 ? function () {} : _ref$onChange;\n  return ReactFiberReconciler({\n    schedulePassiveEffects: unstable_scheduleCallback,\n    cancelPassiveEffects: unstable_cancelCallback,\n    supportsMutation: true,\n    isPrimaryRenderer: false,\n    warnsIfNotActing: false,\n    appendInitialChild: appendChild,\n    createInstance: function createInstance(type, _ref2) {\n      var style = _ref2.style;\n      _ref2.children;\n      var props = _objectWithoutPropertiesLoose(_ref2, _excluded$1);\n      return {\n        type: type,\n        box: {},\n        style: style || {},\n        props: props || {},\n        children: []\n      };\n    },\n    createTextInstance: function createTextInstance(text, rootContainerInstance) {\n      return {\n        type: 'TEXT_INSTANCE',\n        value: text\n      };\n    },\n    finalizeInitialChildren: function finalizeInitialChildren(element, type, props) {\n      return false;\n    },\n    getPublicInstance: function getPublicInstance(instance) {\n      return instance;\n    },\n    prepareForCommit: function prepareForCommit() {\n    },\n    clearContainer: function clearContainer() {\n    },\n    prepareUpdate: function prepareUpdate(element, type, oldProps, newProps) {\n      return !propsEqual(oldProps, newProps);\n    },\n    resetAfterCommit: onChange,\n    resetTextContent: function resetTextContent(element) {\n    },\n    getRootHostContext: function getRootHostContext() {\n      return emptyObject;\n    },\n    getChildHostContext: function getChildHostContext() {\n      return emptyObject;\n    },\n    shouldSetTextContent: function shouldSetTextContent(type, props) {\n      return false;\n    },\n    now: Date.now,\n    useSyncScheduling: true,\n    appendChild: appendChild,\n    appendChildToContainer: function appendChildToContainer(parentInstance, child) {\n      if (parentInstance.type === 'ROOT') {\n        parentInstance.document = child;\n      } else {\n        appendChild(parentInstance, child);\n      }\n    },\n    insertBefore: function insertBefore(parentInstance, child, beforeChild) {\n      var _parentInstance$child;\n      var index = (_parentInstance$child = parentInstance.children) === null || _parentInstance$child === void 0 ? void 0 : _parentInstance$child.indexOf(beforeChild);\n      if (index === undefined) return;\n      if (index !== -1 && child) parentInstance.children.splice(index, 0, child);\n    },\n    removeChild: function removeChild(parentInstance, child) {\n      var _parentInstance$child2;\n      var index = (_parentInstance$child2 = parentInstance.children) === null || _parentInstance$child2 === void 0 ? void 0 : _parentInstance$child2.indexOf(child);\n      if (index === undefined) return;\n      if (index !== -1) parentInstance.children.splice(index, 1);\n    },\n    removeChildFromContainer: function removeChildFromContainer(parentInstance, child) {\n      var _parentInstance$child3;\n      var index = (_parentInstance$child3 = parentInstance.children) === null || _parentInstance$child3 === void 0 ? void 0 : _parentInstance$child3.indexOf(child);\n      if (index === undefined) return;\n      if (index !== -1) parentInstance.children.splice(index, 1);\n    },\n    commitTextUpdate: function commitTextUpdate(textInstance, oldText, newText) {\n      textInstance.value = newText;\n    },\n    commitUpdate: function commitUpdate(instance, updatePayload, type, oldProps, newProps) {\n      var style = newProps.style,\n        props = _objectWithoutPropertiesLoose(newProps, _excluded2);\n      instance.props = props;\n      instance.style = style;\n    }\n  });\n};\nvar version = \"3.0.1\";\nvar fontStore = new FontStore();\n\nvar renderer;\n\nvar events = {};\nvar pdf = function pdf(initialValue) {\n  var onChange = function onChange() {\n    var _events$change;\n    var listeners = ((_events$change = events.change) === null || _events$change === void 0 ? void 0 : _events$change.slice()) || [];\n    for (var i = 0; i < listeners.length; i += 1) {\n      listeners[i]();\n    }\n  };\n  var container = {\n    type: 'ROOT',\n    document: null\n  };\n  renderer = renderer || createRenderer({\n    onChange: onChange\n  });\n  var mountNode = renderer.createContainer(container);\n  var updateContainer = function updateContainer(doc) {\n    renderer.updateContainer(doc, mountNode, null);\n  };\n  if (initialValue) updateContainer(initialValue);\n  var render = function () {\n    var _ref = _asyncToGenerator(_regeneratorRuntime.mark(function _callee(compress) {\n      var props, pdfVersion, language, pageLayout, pageMode, ctx, layout;\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              if (compress === void 0) {\n                compress = true;\n              }\n              props = container.document.props || {};\n              pdfVersion = props.pdfVersion, language = props.language, pageLayout = props.pageLayout, pageMode = props.pageMode;\n              ctx = new PDFDocument({\n                compress: compress,\n                pdfVersion: pdfVersion,\n                lang: language,\n                displayTitle: true,\n                autoFirstPage: false,\n                pageLayout: pageLayout,\n                pageMode: pageMode\n              });\n              _context.next = 6;\n              return layoutDocument(container.document, fontStore);\n            case 6:\n              layout = _context.sent;\n              return _context.abrupt(\"return\", renderPDF(ctx, layout));\n            case 8:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee);\n    }));\n    return function render(_x) {\n      return _ref.apply(this, arguments);\n    };\n  }();\n  var callOnRender = function callOnRender(params) {\n    if (params === void 0) {\n      params = {};\n    }\n    if (container.document.props.onRender) {\n      container.document.props.onRender(params);\n    }\n  };\n  var toBlob = function () {\n    var _ref2 = _asyncToGenerator(_regeneratorRuntime.mark(function _callee2() {\n      var chunks, instance;\n      return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              chunks = [];\n              _context2.next = 3;\n              return render();\n            case 3:\n              instance = _context2.sent;\n              return _context2.abrupt(\"return\", new Promise(function (resolve, reject) {\n                instance.on('data', function (chunk) {\n                  chunks.push(chunk instanceof Uint8Array ? chunk : new Uint8Array(chunk));\n                });\n                instance.on('end', function () {\n                  try {\n                    var blob = new Blob(chunks, {\n                      type: 'application/pdf'\n                    });\n                    callOnRender({\n                      blob: blob\n                    });\n                    resolve(blob);\n                  } catch (error) {\n                    reject(error);\n                  }\n                });\n              }));\n            case 5:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, _callee2);\n    }));\n    return function toBlob() {\n      return _ref2.apply(this, arguments);\n    };\n  }();\n  var toBuffer = function () {\n    var _ref3 = _asyncToGenerator(_regeneratorRuntime.mark(function _callee3() {\n      return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n        while (1) {\n          switch (_context3.prev = _context3.next) {\n            case 0:\n              callOnRender();\n              return _context3.abrupt(\"return\", render());\n            case 2:\n            case \"end\":\n              return _context3.stop();\n          }\n        }\n      }, _callee3);\n    }));\n    return function toBuffer() {\n      return _ref3.apply(this, arguments);\n    };\n  }();\n  var toString = function () {\n    var _ref4 = _asyncToGenerator(_regeneratorRuntime.mark(function _callee4() {\n      var result, instance;\n      return _regeneratorRuntime.wrap(function _callee4$(_context4) {\n        while (1) {\n          switch (_context4.prev = _context4.next) {\n            case 0:\n              result = '';\n              _context4.next = 3;\n              return render(false);\n            case 3:\n              instance = _context4.sent;\n              return _context4.abrupt(\"return\", new Promise(function (resolve, reject) {\n                try {\n                  instance.on('data', function (buffer) {\n                    result += buffer;\n                  });\n                  instance.on('end', function () {\n                    callOnRender();\n                    resolve(result);\n                  });\n                } catch (error) {\n                  reject(error);\n                }\n              }));\n            case 5:\n            case \"end\":\n              return _context4.stop();\n          }\n        }\n      }, _callee4);\n    }));\n    return function toString() {\n      return _ref4.apply(this, arguments);\n    };\n  }();\n  var on = function on(event, listener) {\n    if (!events[event]) events[event] = [];\n    events[event].push(listener);\n  };\n  var removeListener = function removeListener(event, listener) {\n    if (!events[event]) return;\n    var idx = events[event].indexOf(listener);\n    if (idx > -1) events[event].splice(idx, 1);\n  };\n  return {\n    on: on,\n    container: container,\n    toBlob: toBlob,\n    toBuffer: toBuffer,\n    toString: toString,\n    removeListener: removeListener,\n    updateContainer: updateContainer\n  };\n};\nvar Font = fontStore;\nvar StyleSheet = {\n  create: function create(s) {\n    return s;\n  }\n};\nvar usePDF = function usePDF(_ref) {\n  var document = _ref.document;\n  var pdfInstance = useRef(null);\n  var _useState = useState({\n      url: null,\n      blob: null,\n      error: null,\n      loading: false\n    }),\n    state = _useState[0],\n    setState = _useState[1];\n\n  useEffect(function () {\n    var renderQueue = queue({\n      autostart: true,\n      concurrency: 1\n    });\n    var queueDocumentRender = function queueDocumentRender() {\n      setState(function (prev) {\n        return _extends({}, prev, {\n          loading: true\n        });\n      });\n      renderQueue.splice(0, renderQueue.length, function () {\n        return state.error ? Promise.resolve() : pdfInstance.current.toBlob();\n      });\n    };\n    var onRenderFailed = function onRenderFailed(error) {\n      console.error(error);\n      setState(function (prev) {\n        return _extends({}, prev, {\n          error: error\n        });\n      });\n    };\n    var onRenderSuccessful = function onRenderSuccessful(blob) {\n      setState({\n        blob: blob,\n        error: null,\n        loading: false,\n        url: URL.createObjectURL(blob)\n      });\n    };\n    pdfInstance.current = pdf();\n    pdfInstance.current.on('change', queueDocumentRender);\n    pdfInstance.current.updateContainer(document);\n    renderQueue.on('error', onRenderFailed);\n    renderQueue.on('success', onRenderSuccessful);\n    return function () {\n      renderQueue.end();\n      pdfInstance.current.removeListener('change', queueDocumentRender);\n    };\n  }, []);\n\n  useEffect(function () {\n    return function () {\n      if (state.url) {\n        URL.revokeObjectURL(state.url);\n      }\n    };\n  }, [state.url]);\n  var update = function update() {\n    pdfInstance.current.updateContainer(document);\n  };\n  return [state, update];\n};\nvar _excluded = [\"title\", \"style\", \"className\", \"children\", \"innerRef\", \"showToolbar\"];\nvar PDFViewer = function PDFViewer(_ref) {\n  var title = _ref.title,\n    style = _ref.style,\n    className = _ref.className,\n    children = _ref.children,\n    innerRef = _ref.innerRef,\n    _ref$showToolbar = _ref.showToolbar,\n    showToolbar = _ref$showToolbar === void 0 ? true : _ref$showToolbar,\n    props = _objectWithoutPropertiesLoose(_ref, _excluded);\n  var _usePDF = usePDF({\n      document: children\n    }),\n    instance = _usePDF[0],\n    updateInstance = _usePDF[1];\n  useEffect(updateInstance, [children]);\n  var src = instance.url ? instance.url + \"#toolbar=\" + (showToolbar ? 1 : 0) : null;\n  return React.createElement(\"iframe\", _extends({\n    src: src,\n    title: title,\n    ref: innerRef,\n    style: style,\n    className: className\n  }, props));\n};\n\nvar BlobProvider = function BlobProvider(_ref) {\n  var doc = _ref.document,\n    children = _ref.children;\n  var _usePDF = usePDF({\n      document: doc\n    }),\n    instance = _usePDF[0],\n    updateInstance = _usePDF[1];\n  useEffect(updateInstance, [doc]);\n  if (!doc) {\n    console.warn('You should pass a valid document to BlobProvider');\n    return null;\n  }\n  return children(instance);\n};\n\nvar PDFDownloadLink = function PDFDownloadLink(_ref) {\n  var style = _ref.style,\n    children = _ref.children,\n    className = _ref.className,\n    doc = _ref.document,\n    _ref$fileName = _ref.fileName,\n    fileName = _ref$fileName === void 0 ? 'document.pdf' : _ref$fileName,\n    onClick = _ref.onClick;\n  var _usePDF = usePDF({\n      document: doc\n    }),\n    instance = _usePDF[0],\n    updateInstance = _usePDF[1];\n  useEffect(updateInstance, [children]);\n  if (!doc) {\n    console.warn('You should pass a valid document to PDFDownloadLink');\n    return null;\n  }\n  var handleDownloadIE = function handleDownloadIE() {\n    if (window.navigator.msSaveBlob) {\n      window.navigator.msSaveBlob(instance.blob, fileName);\n    }\n  };\n  var handleClick = function handleClick(event) {\n    handleDownloadIE();\n    if (typeof onClick === 'function') onClick(event, instance);\n  };\n  return React.createElement(\"a\", {\n    style: style,\n    href: instance.url,\n    download: fileName,\n    className: className,\n    onClick: handleClick\n  }, typeof children === 'function' ? children(instance) : children);\n};\nvar throwEnvironmentError = function throwEnvironmentError(name) {\n  throw new Error(name + \" is a Node specific API. You're either using this method in a browser, or your bundler is not loading react-pdf from the appropriate web build.\");\n};\nvar renderToStream = function renderToStream() {\n  throwEnvironmentError('renderToStream');\n};\nvar renderToString = function renderToString() {\n  throwEnvironmentError('renderToString');\n};\nvar renderToFile = function renderToFile() {\n  throwEnvironmentError('renderToFile');\n};\nvar render = function render() {\n  throwEnvironmentError('render');\n};\nvar index = _extends({\n  pdf: pdf,\n  usePDF: usePDF,\n  Font: Font,\n  version: version,\n  StyleSheet: StyleSheet,\n  PDFViewer: PDFViewer,\n  BlobProvider: BlobProvider,\n  PDFDownloadLink: PDFDownloadLink,\n  renderToStream: renderToStream,\n  renderToString: renderToString,\n  renderToFile: renderToFile,\n  render: render\n}, primitives);\nexport { BlobProvider, Font, PDFDownloadLink, PDFViewer, StyleSheet, createRenderer, index as default, pdf, render, renderToFile, renderToStream, renderToString, usePDF, version };","map":{"version":3,"sources":["../src/utils/propsEqual.js","../src/renderer.js","../src/index.js","../src/dom/usePDF.js","../src/dom/PDFViewer.js","../src/dom/BlobProvider.js","../src/dom/PDFDownloadLink.js","../src/dom/index.js"],"names":["propsEqual","a","b","oldPropsKeys","Object","keys","newPropsKeys","length","i","propName","emptyObject","appendChild","parentInstance","child","isParentText","type","isChildTextInstance","isOrphanTextInstance","console","warn","value","children","push","createRenderer","onChange","ReactFiberReconciler","schedulePassiveEffects","cancelPassiveEffects","supportsMutation","isPrimaryRenderer","warnsIfNotActing","appendInitialChild","createInstance","style","props","box","createTextInstance","text","rootContainerInstance","finalizeInitialChildren","element","getPublicInstance","instance","prepareForCommit","clearContainer","prepareUpdate","oldProps","newProps","resetAfterCommit","resetTextContent","getRootHostContext","getChildHostContext","shouldSetTextContent","now","Date","useSyncScheduling","appendChildToContainer","document","insertBefore","beforeChild","index","indexOf","undefined","splice","removeChild","removeChildFromContainer","commitTextUpdate","textInstance","oldText","newText","commitUpdate","updatePayload","fontStore","FontStore","renderer","events","pdf","listeners","change","slice","container","mountNode","createContainer","updateContainer","doc","initialValue","render","compress","pdfVersion","language","pageLayout","pageMode","ctx","PDFDocument","lang","displayTitle","autoFirstPage","layout","layoutDocument","renderPDF","callOnRender","params","onRender","toBlob","chunks","Promise","resolve","reject","on","chunk","Uint8Array","blob","Blob","error","toBuffer","toString","result","buffer","event","listener","removeListener","idx","Font","StyleSheet","create","s","usePDF","pdfInstance","useRef","state","setState","useState","url","loading","useEffect","renderQueue","queue","autostart","concurrency","queueDocumentRender","prev","current","onRenderFailed","onRenderSuccessful","URL","createObjectURL","end","revokeObjectURL","update","PDFViewer","title","className","innerRef","showToolbar","updateInstance","src","BlobProvider","PDFDownloadLink","fileName","onClick","handleDownloadIE","window","navigator","msSaveBlob","handleClick","throwEnvironmentError","Error","name","renderToStream","renderToString","renderToFile","version","primitives"],"mappings":"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","sourcesContent":["/* eslint-disable no-continue */\n\n/**\n * Checks if two sets of props are equal (recursively)\n *\n * @param {Object} props A\n * @param {Object} props B\n * @returns {Boolean} props equals?\n *\n */\nconst propsEqual = (a, b) => {\n  const oldPropsKeys = Object.keys(a);\n  const newPropsKeys = Object.keys(b);\n\n  if (oldPropsKeys.length !== newPropsKeys.length) {\n    return false;\n  }\n\n  for (let i = 0; i < oldPropsKeys.length; i += 1) {\n    const propName = oldPropsKeys[i];\n\n    if (propName === 'render' && !a[propName] !== !b[propName]) {\n      return false;\n    }\n\n    if (propName !== 'children' && a[propName] !== b[propName]) {\n      if (\n        typeof a[propName] === 'object' &&\n        typeof b[propName] === 'object' &&\n        propsEqual(a[propName], b[propName])\n      ) {\n        continue;\n      }\n\n      return false;\n    }\n\n    if (\n      propName === 'children' &&\n      (typeof a[propName] === 'string' || typeof b[propName] === 'string')\n    ) {\n      return a[propName] === b[propName];\n    }\n  }\n\n  return true;\n};\n\nexport default propsEqual;\n","/* eslint-disable no-unused-vars */\n/* eslint-disable no-param-reassign */\n\nimport ReactFiberReconciler from 'react-reconciler';\nimport {\n  unstable_scheduleCallback as schedulePassiveEffects,\n  unstable_cancelCallback as cancelPassiveEffects,\n} from 'scheduler';\n\nimport propsEqual from './utils/propsEqual';\n\nconst emptyObject = {};\n\nconst appendChild = (parentInstance, child) => {\n  const isParentText = parentInstance.type === 'TEXT';\n  const isChildTextInstance = child.type === 'TEXT_INSTANCE';\n  const isOrphanTextInstance = isChildTextInstance && !isParentText;\n\n  // Ignore orphan text instances.\n  // Caused by cases such as <>{name && <Text>{name}</Text>}</>\n  if (isOrphanTextInstance) {\n    console.warn(\n      `Invalid '${child.value}' string child outside <Text> component`,\n    );\n    return;\n  }\n\n  parentInstance.children.push(child);\n};\n\nconst createRenderer = ({ onChange = () => {} }) => {\n  return ReactFiberReconciler({\n    schedulePassiveEffects,\n\n    cancelPassiveEffects,\n\n    supportsMutation: true,\n\n    isPrimaryRenderer: false,\n\n    warnsIfNotActing: false,\n\n    appendInitialChild: appendChild,\n\n    createInstance(type, { style, children, ...props }) {\n      return {\n        type,\n        box: {},\n        style: style || {},\n        props: props || {},\n        children: [],\n      };\n    },\n\n    createTextInstance(text, rootContainerInstance) {\n      return { type: 'TEXT_INSTANCE', value: text };\n    },\n\n    finalizeInitialChildren(element, type, props) {\n      return false;\n    },\n\n    getPublicInstance(instance) {\n      return instance;\n    },\n\n    prepareForCommit() {\n      // Noop\n    },\n\n    clearContainer() {\n      // Noop\n    },\n\n    prepareUpdate(element, type, oldProps, newProps) {\n      return !propsEqual(oldProps, newProps);\n    },\n\n    resetAfterCommit: onChange,\n\n    resetTextContent(element) {\n      // Noop\n    },\n\n    getRootHostContext() {\n      return emptyObject;\n    },\n\n    getChildHostContext() {\n      return emptyObject;\n    },\n\n    shouldSetTextContent(type, props) {\n      return false;\n    },\n\n    now: Date.now,\n\n    useSyncScheduling: true,\n\n    appendChild,\n\n    appendChildToContainer(parentInstance, child) {\n      if (parentInstance.type === 'ROOT') {\n        parentInstance.document = child;\n      } else {\n        appendChild(parentInstance, child);\n      }\n    },\n\n    insertBefore(parentInstance, child, beforeChild) {\n      const index = parentInstance.children?.indexOf(beforeChild);\n\n      if (index === undefined) return;\n\n      if (index !== -1 && child)\n        parentInstance.children.splice(index, 0, child);\n    },\n\n    removeChild(parentInstance, child) {\n      const index = parentInstance.children?.indexOf(child);\n\n      if (index === undefined) return;\n\n      if (index !== -1) parentInstance.children.splice(index, 1);\n    },\n\n    removeChildFromContainer(parentInstance, child) {\n      const index = parentInstance.children?.indexOf(child);\n\n      if (index === undefined) return;\n\n      if (index !== -1) parentInstance.children.splice(index, 1);\n    },\n\n    commitTextUpdate(textInstance, oldText, newText) {\n      textInstance.value = newText;\n    },\n\n    commitUpdate(instance, updatePayload, type, oldProps, newProps) {\n      const { style, ...props } = newProps;\n      instance.props = props;\n      instance.style = style;\n    },\n  });\n};\n\nexport default createRenderer;\n","import FontStore from '@react-pdf/font';\nimport renderPDF from '@react-pdf/render';\nimport PDFDocument from '@react-pdf/pdfkit';\nimport layoutDocument from '@react-pdf/layout';\n\nimport createRenderer from './renderer';\nimport { version } from '../package.json';\n\nconst fontStore = new FontStore();\n\n// We must keep a single renderer instance, otherwise React will complain\nlet renderer;\n\n// The pdf instance acts as an event emitter for DOM usage.\n// We only want to trigger an update when PDF content changes\nconst events = {};\n\nconst pdf = initialValue => {\n  const onChange = () => {\n    const listeners = events.change?.slice() || [];\n    for (let i = 0; i < listeners.length; i += 1) listeners[i]();\n  };\n\n  const container = { type: 'ROOT', document: null };\n  renderer = renderer || createRenderer({ onChange });\n  const mountNode = renderer.createContainer(container);\n\n  const updateContainer = doc => {\n    renderer.updateContainer(doc, mountNode, null);\n  };\n\n  if (initialValue) updateContainer(initialValue);\n\n  const render = async (compress = true) => {\n    const props = container.document.props || {};\n    const { pdfVersion, language, pageLayout, pageMode } = props;\n\n    const ctx = new PDFDocument({\n      compress,\n      pdfVersion,\n      lang: language,\n      displayTitle: true,\n      autoFirstPage: false,\n      pageLayout,\n      pageMode,\n    });\n\n    const layout = await layoutDocument(container.document, fontStore);\n\n    return renderPDF(ctx, layout);\n  };\n\n  const callOnRender = (params = {}) => {\n    if (container.document.props.onRender) {\n      container.document.props.onRender(params);\n    }\n  };\n\n  const toBlob = async () => {\n    const chunks = [];\n    const instance = await render();\n\n    return new Promise((resolve, reject) => {\n      instance.on('data', chunk => {\n        chunks.push(\n          chunk instanceof Uint8Array ? chunk : new Uint8Array(chunk),\n        );\n      });\n\n      instance.on('end', () => {\n        try {\n          const blob = new Blob(chunks, { type: 'application/pdf' });\n          callOnRender({ blob });\n          resolve(blob);\n        } catch (error) {\n          reject(error);\n        }\n      });\n    });\n  };\n\n  const toBuffer = async () => {\n    callOnRender();\n    return render();\n  };\n\n  const toString = async () => {\n    let result = '';\n    const instance = await render(false); // For some reason, when rendering to string if compress=true the document is blank\n\n    return new Promise((resolve, reject) => {\n      try {\n        instance.on('data', buffer => {\n          result += buffer;\n        });\n\n        instance.on('end', () => {\n          callOnRender();\n          resolve(result);\n        });\n      } catch (error) {\n        reject(error);\n      }\n    });\n  };\n\n  const on = (event, listener) => {\n    if (!events[event]) events[event] = [];\n    events[event].push(listener);\n  };\n\n  const removeListener = (event, listener) => {\n    if (!events[event]) return;\n    const idx = events[event].indexOf(listener);\n    if (idx > -1) events[event].splice(idx, 1);\n  };\n\n  return {\n    on,\n    container,\n    toBlob,\n    toBuffer,\n    toString,\n    removeListener,\n    updateContainer,\n  };\n};\n\nconst Font = fontStore;\n\nconst StyleSheet = {\n  create: s => s,\n};\n\nexport { version, Font, StyleSheet, pdf, createRenderer };\n","/* eslint-disable no-console */\n\nimport queue from 'queue';\nimport { useState, useRef, useEffect } from 'react';\n\nimport { pdf } from '../index';\n\nexport const usePDF = ({ document }) => {\n  const pdfInstance = useRef(null);\n\n  const [state, setState] = useState({\n    url: null,\n    blob: null,\n    error: null,\n    loading: false,\n  });\n\n  // Setup rendering queue\n  useEffect(() => {\n    const renderQueue = queue({ autostart: true, concurrency: 1 });\n\n    const queueDocumentRender = () => {\n      setState(prev => ({ ...prev, loading: true }));\n\n      renderQueue.splice(0, renderQueue.length, () =>\n        state.error ? Promise.resolve() : pdfInstance.current.toBlob(),\n      );\n    };\n\n    const onRenderFailed = error => {\n      console.error(error);\n      setState(prev => ({ ...prev, error }));\n    };\n\n    const onRenderSuccessful = blob => {\n      setState({\n        blob,\n        error: null,\n        loading: false,\n        url: URL.createObjectURL(blob),\n      });\n    };\n\n    pdfInstance.current = pdf();\n    pdfInstance.current.on('change', queueDocumentRender);\n    pdfInstance.current.updateContainer(document);\n\n    renderQueue.on('error', onRenderFailed);\n    renderQueue.on('success', onRenderSuccessful);\n\n    return () => {\n      renderQueue.end();\n      pdfInstance.current.removeListener('change', queueDocumentRender);\n    };\n  }, []);\n\n  // Revoke old unused url instances\n  useEffect(() => {\n    return () => {\n      if (state.url) {\n        URL.revokeObjectURL(state.url);\n      }\n    };\n  }, [state.url]);\n\n  const update = () => {\n    pdfInstance.current.updateContainer(document);\n  };\n\n  return [state, update];\n};\n\nexport default usePDF;\n","/* eslint-disable no-console */\n/* eslint-disable react/jsx-props-no-spreading */\n\nimport React, { useEffect } from 'react';\n\nimport usePDF from './usePDF';\n\nexport const PDFViewer = ({\n  title,\n  style,\n  className,\n  children,\n  innerRef,\n  showToolbar = true,\n  ...props\n}) => {\n  const [instance, updateInstance] = usePDF({ document: children });\n\n  useEffect(updateInstance, [children]);\n\n  const src = instance.url\n    ? `${instance.url}#toolbar=${showToolbar ? 1 : 0}`\n    : null;\n\n  return (\n    <iframe\n      src={src}\n      title={title}\n      ref={innerRef}\n      style={style}\n      className={className}\n      {...props}\n    />\n  );\n};\n\nexport default PDFViewer;\n","/* eslint-disable no-console */\n\nimport { useEffect } from 'react';\n\nimport usePDF from './usePDF';\n\nexport const BlobProvider = ({ document: doc, children }) => {\n  const [instance, updateInstance] = usePDF({ document: doc });\n\n  useEffect(updateInstance, [doc]);\n\n  if (!doc) {\n    console.warn('You should pass a valid document to BlobProvider');\n    return null;\n  }\n\n  return children(instance);\n};\n\nexport default BlobProvider;\n","/* eslint-disable no-console */\n\nimport React, { useEffect } from 'react';\n\nimport usePDF from './usePDF';\n\nexport const PDFDownloadLink = ({\n  style,\n  children,\n  className,\n  document: doc,\n  fileName = 'document.pdf',\n  onClick,\n}) => {\n  const [instance, updateInstance] = usePDF({ document: doc });\n\n  useEffect(updateInstance, [children]);\n\n  if (!doc) {\n    console.warn('You should pass a valid document to PDFDownloadLink');\n    return null;\n  }\n\n  const handleDownloadIE = () => {\n    if (window.navigator.msSaveBlob) {\n      // IE\n      window.navigator.msSaveBlob(instance.blob, fileName);\n    }\n  };\n\n  const handleClick = event => {\n    handleDownloadIE();\n    if (typeof onClick === 'function') onClick(event, instance);\n  };\n\n  return (\n    <a\n      style={style}\n      href={instance.url}\n      download={fileName}\n      className={className}\n      onClick={handleClick}\n    >\n      {typeof children === 'function' ? children(instance) : children}\n    </a>\n  );\n};\n\nexport default PDFDownloadLink;\n","import * as primitives from '@react-pdf/primitives';\n\nimport usePDF from './usePDF';\nimport PDFViewer from './PDFViewer';\nimport BlobProvider from './BlobProvider';\nimport PDFDownloadLink from './PDFDownloadLink';\nimport { pdf, version, Font, StyleSheet } from '../index';\n\nconst throwEnvironmentError = name => {\n  throw new Error(\n    `${name} is a Node specific API. You're either using this method in a browser, or your bundler is not loading react-pdf from the appropriate web build.`,\n  );\n};\n\nexport const renderToStream = () => {\n  throwEnvironmentError('renderToStream');\n};\n\nexport const renderToString = () => {\n  throwEnvironmentError('renderToString');\n};\n\nexport const renderToFile = () => {\n  throwEnvironmentError('renderToFile');\n};\n\nexport const render = () => {\n  throwEnvironmentError('render');\n};\n\nexport * from '../index';\n\nexport * from './usePDF';\n\nexport * from './PDFViewer';\n\nexport * from './BlobProvider';\n\nexport * from './PDFDownloadLink';\n\nexport * from '@react-pdf/primitives';\n\nexport default {\n  pdf,\n  usePDF,\n  Font,\n  version,\n  StyleSheet,\n  PDFViewer,\n  BlobProvider,\n  PDFDownloadLink,\n  renderToStream,\n  renderToString,\n  renderToFile,\n  render,\n  ...primitives,\n};\n"]},"metadata":{},"sourceType":"module"}